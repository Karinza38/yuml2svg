#!/usr/bin/env node

if (process.stdin.isTTY) {
  console.log("Usage: cat diagram.yuml | yuml2svg > diagram.svg");
  console.log("\tTakes yUML diagram via stdin and outputs SVG to stdout.");
  console.log("\tOption: --dark to generate SVG with dark mode.");
} else {
  const isDark = process.argv[2] === "--dark";
  import("../index.mjs")
    .then(module => module.default(process.stdin, { isDark }))
    .then(svg => process.stdout.write(svg))
    .catch(e => {
      console.error(e);
      if (e.message === "Not supported") {
        console.warn(
          "It seems ES Modules support is not available on the node version",
          "you are using. You can try to run `yuml2svg-compat` instead."
        );
      }
    });
}
